function parseFrontmatter(e){const s="---",t=e.indexOf(s);if(-1===t)return{frontmatter:{},body:e.trim()};const n=e.slice(t+3),i=n.indexOf(s);if(-1===i)return{frontmatter:{},body:e.trim()};const r=n.slice(0,i).trim(),a=n.slice(i+3).trim(),l={},o=r.split("\n");let c=0;for(;c<o.length;){const e=o[c],s=e.match(/^(\w+):\s*(.*)$/);if(s){const[,e,t]=s;let n=t.trim();n.startsWith('"')&&n.endsWith('"')||n.startsWith("'")&&n.endsWith("'")?n=n.slice(1,-1).replace(/\\"/g,'"'):"true"===n?n=!0:"false"===n?n=!1:/^\d+$/.test(n)&&(n=parseInt(n,10)),"exercises"!==e&&(l[e]=n)}if(e.match(/^exercises:\s*$/)){const e=[],s=(e,s)=>{const t=new RegExp(`${e}:\\s*(["'])((?:\\\\.|(?!\\1)[\\s\\S])*)\\1`),n=s.match(t);return n?n[2].replace(/\\(.)/g,"$1"):null};for(c++;c<o.length;){const t=o[c];if(t.match(/^\s+-\s+question:/)){const n={question:"",answer:"",hint:""},i=s("question",t);for(null!=i&&(n.question=i),c++;c<o.length&&!o[c].match(/^\s+-\s+question:/);){const e=o[c],t=s("answer",e),i=s("hint",e);null!=t&&(n.answer=t),null!=i&&(n.hint=i),c++}n.question&&n.answer&&e.push(n)}else c++}l.exercises=e;continue}c++}return{frontmatter:l,body:a}}function renderBody(e){return"undefined"==typeof marked?escapeHtml(e).replace(/\n/g,"<br>"):marked.parse(e)}function highlightCodeBlocks(e){"undefined"!=typeof hljs&&e&&e.querySelectorAll("pre code").forEach(e=>{hljs.highlightElement(e)})}function ensureSectionIds(e){if(!e)return;const s=e.querySelectorAll(".iss-prose h2"),t=["resumo","explicacoes"];s.forEach((e,s)=>{t[s]&&(e.id=t[s])})}function renderExercisesHTML(e,s,t,n){if(!Array.isArray(e)||0===e.length)return"";const i=n instanceof Set?n:new Set;return`\n  <h2 id="exercicios" class="text-xl font-semibold mt-8 mb-4 pb-1 border-b iss-border">Exercícios</h2>\n  <div class="space-y-4">${e.map((e,n)=>{const r=`${s}_${t}_${n}`,a=i.has(r),l=a?' <span class="iss-exercise__revisado-label text-sm iss-text-muted">Revisado</span>':"";return`\n    <div class="iss-exercise${a?" iss-exercise--revisado":""}" data-exercise-id="${escapeHtml(r)}">\n      <p class="font-medium mb-2">${escapeHtml(e.question)}${l}</p>\n      <details class="group">\n        <summary class="iss-exercise__toggle cursor-pointer list-none">\n          <span class="inline">Ver resposta sugerida</span>\n        </summary>\n        <div class="mt-3 pt-3 border-t iss-border">\n          <p class="mb-0">${escapeHtml(e.answer)}</p>\n          ${e.hint?`<p class="text-sm iss-text-muted mt-2 mb-0"><strong>Dica:</strong> ${escapeHtml(e.hint)}</p>`:""}\n        </div>\n      </details>\n    </div>\n  `}).join("")}</div>\n  `}function renderPrevNextNav(e,s,t){if(!e&&!s)return"";return`<nav class="mt-8 pt-6 border-t iss-border flex justify-between text-sm" aria-label="Navegação entre aulas">${e?`<a href="aula.html?d=${encodeURIComponent(t)}&a=${encodeURIComponent(e.slug)}" class="iss-link">Aula anterior</a>`:'<span class="iss-text-muted">Aula anterior</span>'}${s?`<a href="aula.html?d=${encodeURIComponent(t)}&a=${encodeURIComponent(s.slug)}" class="iss-link">Próxima aula</a>`:'<span class="iss-text-muted">Próxima aula</span>'}</nav>`}function renderAulaPage({raw:e,lesson:s,discipline:t,prevLesson:n,nextLesson:i}){const{frontmatter:r,body:a}=parseFrontmatter(e),l=r.title||s.title;document.title=`${l} — ISS`;const o=document.getElementById("breadcrumb-aula");if(o){const e=t?t.slug:new URLSearchParams(window.location.search).get("d")||"";o.innerHTML=`\n      <a href="index.html" class="iss-link-muted">Home</a>\n      <span class="iss-text-muted mx-1">/</span>\n      <a href="disciplina.html?d=${encodeURIComponent(e)}" class="iss-link-muted">${escapeHtml(t?t.title:e)}</a>\n      <span class="iss-text-muted mx-1">/</span>\n      <span>${escapeHtml(l)}</span>\n    `}const c=document.getElementById("lesson-title");c&&(c.textContent=l);const d=document.getElementById("lesson-content");if(d){const e=a.trim().split(/\s+/).filter(Boolean).length,l=`<p class="iss-reading-time iss-text-muted text-sm mb-4">~${null!=r.readingMinutes?Math.max(1,parseInt(r.readingMinutes,10)||1):Math.max(1,Math.ceil(e/200))} min de leitura</p>`,o=renderBody(a),c="undefined"!=typeof getReviewedExerciseIds?getReviewedExerciseIds():new Set,m=t?t.slug:"",u=renderExercisesHTML(r.exercises||[],m,s.slug,c),p=renderPrevNextNav(n||null,i||null,m);d.innerHTML=`${l}<nav class="mb-6 text-sm" aria-label="Nesta página"><a href="#resumo" class="iss-link-muted mr-3">Resumo</a><a href="#explicacoes" class="iss-link-muted mr-3">Explicações</a><a href="#exercicios" class="iss-link-muted">Exercícios</a></nav><div class="iss-prose">${o}</div>${u}${p}`,d.querySelectorAll("img").forEach(e=>e.setAttribute("loading","lazy")),d.querySelectorAll("iframe").forEach(e=>e.setAttribute("loading","lazy")),highlightCodeBlocks(d),ensureSectionIds(d),d.querySelectorAll(".iss-exercise").forEach(e=>{const s=e.querySelector("details"),t=e.getAttribute("data-exercise-id");s&&t&&"undefined"!=typeof markExerciseAsReviewed&&s.addEventListener("toggle",()=>{if(s.open){markExerciseAsReviewed(t),e.classList.add("iss-exercise--revisado");if(!e.querySelector(".iss-exercise__revisado-label")){const s=e.querySelector("p.font-medium");if(s){const e=document.createElement("span");e.className="iss-exercise__revisado-label text-sm iss-text-muted",e.textContent=" Revisado",s.appendChild(e)}}}})})}}