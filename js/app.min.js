function getParam(e){return"undefined"!=typeof Router?Router.getParam(e):new URLSearchParams(window.location.search).get(e)||""}function initHome(){const e=document.getElementById("disciplines-list");e&&fetchDisciplines().then(n=>{0!==n.length?e.innerHTML=n.map(e=>`\n        <a href="disciplina.html?d=${encodeURIComponent(e.slug)}" class="iss-card block no-underline text-inherit">\n          <h3 class="font-semibold text-lg m-0">${escapeHtml(e.title)}</h3>\n          ${e.description?`<p class="text-sm iss-text-muted mt-1 mb-0">${escapeHtml(e.description)}</p>`:""}\n        </a>\n      `).join(""):e.innerHTML='<p class="iss-text-muted">Nenhuma disciplina disponível.</p>'}).catch(n=>{e.innerHTML='<p class="text-red-600">Erro ao carregar disciplinas.</p>',console.error(n)})}function initDisciplina(){const e=getParam("d"),n=document.getElementById("lessons-list"),t=document.getElementById("discipline-title"),i=document.getElementById("breadcrumb-discipline");e?Promise.all([fetchDisciplines(),fetchLessons()]).then(([s,a])=>{const o=getDiscipline(s,e),l=getLessonsByDiscipline(a,e);return o?0===l.length?(t&&(t.textContent=o.title),i&&(i.innerHTML=`\n            <a href="index.html" class="iss-link-muted">Home</a>\n            <span class="iss-text-muted mx-1">/</span>\n            <span>${escapeHtml(o.title)}</span>\n          `),void(n&&(n.innerHTML='<p class="iss-text-muted mb-4">Nenhuma aula publicada ainda.</p><a href="index.html" class="iss-link hover:underline">Voltar à página inicial</a>'))):(t&&(t.textContent=o.title),i&&(i.innerHTML=`\n          <a href="index.html" class="iss-link-muted">Home</a>\n          <span class="iss-text-muted mx-1">/</span>\n          <span>${escapeHtml(o.title)}</span>\n        `),void(n&&(n.innerHTML=l.map(n=>`\n          <a href="aula.html?d=${encodeURIComponent(e)}&a=${encodeURIComponent(n.slug)}" class="iss-card block no-underline text-inherit">\n            <span class="font-medium">${escapeHtml(n.title)}</span>\n          </a>\n        `).join("")))):(t&&(t.textContent="Disciplina não encontrada"),i&&(i.innerHTML='<a href="index.html" class="iss-link-muted">Home</a>'),void(n&&(n.innerHTML='<p class="iss-text-muted mb-4">Esta disciplina não existe.</p><a href="index.html" class="iss-link hover:underline">Voltar à página inicial</a>')))}).catch(()=>{"undefined"!=typeof Router?Router.navigateHome():window.location.href="index.html"}):"undefined"!=typeof Router?Router.navigateHome():window.location.href="index.html"}function initAula(){const e=getParam("d"),n=getParam("a"),t=document.getElementById("lesson-content"),i=document.getElementById("lesson-title"),s=document.getElementById("breadcrumb-aula");function a(e){document.title="Aula não encontrada — ISS",i&&(i.textContent="Aula não encontrada"),s&&(s.innerHTML='<a href="index.html" class="iss-link-muted">Home</a>'),t&&(t.innerHTML='<p class="iss-text-muted mb-4">'+escapeHtml(e)+'</p><a href="index.html" class="iss-link hover:underline">Voltar à página inicial</a>')}e&&n?fetchLessons().then(t=>{const i=getLesson(t,e,n);if(!i)return a("Esta aula não existe."),null;const s=getLessonsByDiscipline(t,e),o=s.findIndex(e=>e.slug===i.slug),l=o>0?s[o-1]:null,c=o>=0&&o<s.length-1?s[o+1]:null;return fetchLessonMarkdown(e,i.file).then(e=>({raw:e,lesson:i,prevLesson:l,nextLesson:c}))}).then(n=>{if(!n)return;const{raw:t,lesson:i,prevLesson:s,nextLesson:a}=n;return fetchDisciplines().then(n=>{const o=getDiscipline(n,e);renderAulaPage({raw:t,lesson:i,discipline:o,prevLesson:s,nextLesson:a})})}).catch(()=>{a("Erro ao carregar o conteúdo da aula.")}):a("Parâmetros de disciplina ou aula em falta.")}function getPageType(){const e=window.location.pathname;return e.endsWith("disciplina.html")?"disciplina":e.endsWith("aula.html")?"aula":"home"}function initBackToTop(){const e=document.getElementById("iss-back-to-top");if(!e)return;function n(){window.scrollY>300?(e.style.display="",e.classList.add("is-visible")):(e.classList.remove("is-visible"),e.style.display="none")}window.addEventListener("scroll",n,{passive:!0}),n(),e.addEventListener("click",e=>{e.preventDefault();const n=!window.matchMedia("(prefers-reduced-motion: reduce)").matches;window.scrollTo({top:0,behavior:n?"smooth":"auto"})})}document.addEventListener("DOMContentLoaded",()=>{const e=getPageType();"home"===e?initHome():"disciplina"===e?(initDisciplina(),initBackToTop()):"aula"===e&&(initAula(),initBackToTop())});